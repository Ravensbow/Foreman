@inject IComponentService ComponentService

@dynamicComponent()

@code {
    [Parameter]
    public string ComponentName { get; set; }
    [Parameter]
    public int InstanceId { get; set; }

    RenderFragment dynamicComponent() => builder =>
    {
        var component = ComponentService.GetComponentByName(ComponentName);
        builder.OpenComponent(0,component.Component);

        for (int i = 0; i < component.Parameters.Count; i++)
        {
            var attribute = component.Parameters.ElementAt(i);
            builder.AddAttribute(i+1,attribute.Key,attribute.Value);
        }
        builder.AddAttribute(component.Parameters.Count, "InstanceId", InstanceId);
        builder.CloseComponent();
    };
}
